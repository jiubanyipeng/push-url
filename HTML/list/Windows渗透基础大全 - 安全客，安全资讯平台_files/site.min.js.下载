var apiHost="https://api.anquanke.com/data/v1/";axios.defaults.withCredentials=true;axios.defaults.headers.common={"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),"X-Requested-With":"XMLHttpRequest"};$(document).ready(function(){$(".search-input").on("keypress",function(event){if(event.keyCode==13){window.location.href="/search?s="+$(this).val()}})});function api(path){return apiHost+path}function getResizedQihooImg(img_url,width,height){try{var url_parsed=$.url(img_url);if(url_parsed.attr("host").indexOf("qhimg.com")>=0&&url_parsed.attr("path").split("/").length===2){return"https://"+url_parsed.attr("host")+"/sdm/"+width+"_"+height+"_100"+url_parsed.attr("path")}return img_url}catch(exception){return img_url}}Handlebars.registerHelper("if_eq",function(v1,v2,opts){if(v1==v2)return opts.fn(this);else return opts.inverse(this)});Handlebars.registerHelper("crop_img",function(img_url,width,height,opts){return getResizedQihooImg(img_url,width,height)});Handlebars.registerHelper("tag_color",function(post_id,opts){var tagColors=["#f50","#2db7f5","#87d068","#ffbb50","#ff5e5c"];return tagColors[post_id%tagColors.length]});Handlebars.registerHelper("if_not_eq",function(v1,v2,opts){if(v1!=v2)return opts.fn(this);else return opts.inverse(this)});Handlebars.registerHelper("safehtml",function(value){return new Handlebars.SafeString(value)});function setValueInput(key,value){if(!document.getElementById("localValue")){var valueDiv=document.createElement("div");valueDiv.id="localValue";document.body.appendChild(valueDiv)}if(!document.getElementById(key)){var valueInput=document.createElement("input");valueInput.id=key;valueInput.type="hidden";document.getElementById("localValue").appendChild(valueInput)}document.getElementById(key).value=value}function getValue(key){if(!document.getElementById(key))return false;return document.getElementById(key).value}function getLocalUserInfo(){if(!getValue("user-info-cached")){return false}return{isLogin:getValue("isLogin")!=="false",user:{id:getValue("user-id"),username:getValue("username"),nickname:getValue("nickname"),avatar:getValue("avatar"),nonce:getValue("nonce"),email:getValue("email")}}}function saveLocalUserInfo(userInfo){setValueInput("user-info-cached",true);setValueInput("isLogin",userInfo.isLogin);if(!userInfo.user)return;setValueInput("user-id",userInfo.user.id);setValueInput("username",userInfo.user.username);setValueInput("nickname",userInfo.user.nickname);setValueInput("avatar",userInfo.user.avatar);setValueInput("nonce",userInfo.user.nonce);setValueInput("email",userInfo.user.email)}function getQueryVariable(variable){var query=window.location.search.substring(1);var vars=query.split("&");for(var i=0;i<vars.length;i++){var pair=vars[i].split("=");if(pair[0]===variable){return pair[1]}}return false}function random(n,m){return Math.floor(Math.random()*(m-n+1)+n)}function deleteUserInfo(){document.getElementById("localValue").innerHTML=""}function captcha(){return apiHost+"util/captcha?r="+Math.random()}var honeySwitch={};honeySwitch.themeColor="rgb(100, 189, 99)";window.switchEvent=function(ele,on,off){$(ele).click(function(){if($(this).hasClass("switch-disabled")){return}if($(this).hasClass("switch-on")){if(typeof on=="function"){on()}}else{if(typeof off=="function"){off()}}})};honeySwitch.init=function(){var s="<span class='slider'></span>";$("[class^=switch]").append(s);$("[class^=switch]").click(function(){if($(this).hasClass("switch-disabled")){return}if($(this).hasClass("switch-on")){$(this).removeClass("switch-on").addClass("switch-off");$(".switch-off").css({"border-color":"#dfdfdf","box-shadow":"rgb(223, 223, 223) 0px 0px 0px 0px inset","background-color":"rgb(255, 255, 255)"})}else{$(this).removeClass("switch-off").addClass("switch-on");if(honeySwitch.themeColor){var c=honeySwitch.themeColor;$(this).css({"border-color":c,"box-shadow":c+" 0px 0px 0px 16px inset","background-color":c})}if($(this).attr("themeColor")){var c2=$(this).attr("themeColor");$(this).css({"border-color":c2,"box-shadow":c2+" 0px 0px 0px 16px inset","background-color":c2})}}});if(this.themeColor){var c=this.themeColor;$(".switch-on").css({"border-color":c,"box-shadow":c+" 0px 0px 0px 16px inset","background-color":c});$(".switch-off").css({"border-color":"#dfdfdf","box-shadow":"rgb(223, 223, 223) 0px 0px 0px 0px inset","background-color":"rgb(255, 255, 255)"})}if($("[themeColor]").length>0){$("[themeColor]").each(function(){var c=$(this).attr("themeColor")||honeySwitch.themeColor;if($(this).hasClass("switch-on")){$(this).css({"border-color":c,"box-shadow":c+" 0px 0px 0px 16px inset","background-color":c})}else{$(".switch-off").css({"border-color":"#dfdfdf","box-shadow":"rgb(223, 223, 223) 0px 0px 0px 0px inset","background-color":"rgb(255, 255, 255)"})}})}};honeySwitch.showOn=function(ele){$(ele).removeClass("switch-off").addClass("switch-on");if(honeySwitch.themeColor){var c=honeySwitch.themeColor;$(ele).css({"border-color":c,"box-shadow":c+" 0px 0px 0px 16px inset","background-color":c})}if($(ele).attr("themeColor")){var c2=$(ele).attr("themeColor");$(ele).css({"border-color":c2,"box-shadow":c2+" 0px 0px 0px 16px inset","background-color":c2})}};honeySwitch.showOff=function(ele){$(ele).removeClass("switch-on").addClass("switch-off");$(".switch-off").css({"border-color":"#dfdfdf","box-shadow":"rgb(223, 223, 223) 0px 0px 0px 0px inset","background-color":"rgb(255, 255, 255)"})};$(function(){honeySwitch.init()});function enterLoading(obj,text){$(obj).attr("disabled","disabled");var originText=$(obj).html();$(obj).html('<i class="fa fa-circle-o-notch fa-spin" style="margin-right:6px;"></i>'+text);return originText}function endLoading(obj,text){$(obj).attr("disabled",false);$(obj).html(text)}function isFollow(target_user_id){axios.get(api("user/follow?target_user_id="+target_user_id)).then(function(res){if(res.data.success){if(res.data.data.self)$(".follow-button").hide();else{$(".follow-button").show();switchFollowButtonStatus(res.data.data.follow)}}});$(".follow-button").click(function(){if(getLocalUserInfo().isLogin){switchFollowButtonStatus($(".follow-button").hasClass("btn-outline-primary"));axios.post(api("user/follow"),{id:target_user_id}).then(function(){})}else{window.location.href="/login"}})}function switchFollowButtonStatus(isFollow){if(isFollow){$(".follow-button").removeClass("btn-outline-primary");$(".follow-button").addClass("btn-primary");$(".follow-button").html('<i class="fa fa-check" style="margin-right:5px;"></i><span>已关注</span>')}else{$(".follow-button").removeClass("btn-primary");$(".follow-button").addClass("btn-outline-primary");$(".follow-button").html('<i class="fa fa-plus" style="margin-right:5px;"></i><span>关注</span>')}}function dynamicLoadScript(url,callback){var scriptLoader=document.createElement("script");scriptLoader.src=url;scriptLoader.onload=function(){callback()};document.getElementById("dynamicScript").appendChild(scriptLoader)}var HtmlUtil={htmlEncode:function(html){var temp=document.createElement("div");temp.textContent!=undefined?temp.textContent=html:temp.innerText=html;var output=temp.innerHTML;temp=null;return output},htmlDecode:function(text){var temp=document.createElement("div");temp.innerHTML=text;var output=temp.innerText||temp.textContent;temp=null;return output},htmlEncodeByRegExp:function(str){var s="";if(str.length==0)return"";s=str.replace(/&/g,"&amp;");s=s.replace(/</g,"&lt;");s=s.replace(/>/g,"&gt;");s=s.replace(/ /g,"&nbsp;");s=s.replace(/\'/g,"&#39;");s=s.replace(/\"/g,"&quot;");return s},htmlDecodeByRegExp:function(str){var s="";if(str.length==0)return"";s=str.replace(/&amp;/g,"&");s=s.replace(/&lt;/g,"<");s=s.replace(/&gt;/g,">");s=s.replace(/&nbsp;/g," ");s=s.replace(/&#39;/g,"'");s=s.replace(/&quot;/g,'"');return s}};